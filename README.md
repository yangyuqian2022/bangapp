四维纵横笔试题
---

# 执行性能分析

测试环境为阿里云2c8g ECS，采用自动生成的数据集，性能测试结果如下:

| 扫描数据集大小 |  Task1(ms) |Task2(ms)|
| ------------ |-------------|---------|
| 1000         |   0.10ms    | 0.03ms  |    
| 1000,000     |   14.10ms   | 0.04ms  |
| 2000,000     |   16.96ms   | 0.04ms  |
| 3000,000     |   25.26ms   | 0.04ms  |
| 4000,000     |   33.27ms   | 0.04ms |


# 任务实现简介

Task1. 顺序扫描，致性时间与数据量线性相关

Task2. 性能得到明显提升，而且如果条件筛选的范围比较小，那基本也不会带来很大的查询开销
* 步骤1. 先解析输入的表达式，将表达式转为维分段扫描的表达式
* 步骤2. 按照分段扫描表达式分段对数据致性扫描

Task3. 涉及一个对结果做排序的操作
* 步骤1. 与Task2同
* 步骤2. 与Task2同，区别在于Task3这里不会直接打印结果，而是缓存到一个队列中，缓存的过程直接实现了插入排序
* 步骤3. 遍历缓存打印结果

Task4. 对Task3方案进一步优化，结果集比较大的情况下，排序出现反复查找/插入的开销，这里采用一个类似hashmap的结构体，维护最新的b->插入位点，这样每个b的值插入的时候只需要做一次复杂度为O(N)的扫描(此处的N为b列的可选值的长度，如可选值最多有100个，那最多就扫描100个元素即可)，后续每次插入操作的复杂度都是O(1)